---
import CompaniesLogos from "@components/astro/CompaniesLogos.astro";
import Layout from "@layouts/Layout.astro";
import Showcase from "@components/astro/Showcase.astro";
import Projects from "@components/astro/Projects.astro";
import Contact from "@components/react/contact/Contact";
import Uses from "@components/react/uses/Uses";
import {Icon} from "astro-icon/components";
import Experience from "@components/astro/Experience.astro";
import {getImage} from "astro:assets";
import image1 from "@assets/images/desk1.jpg";
import image2 from "@assets/images/desk2.jpg";
import image3 from "@assets/images/desk3.jpg";
import image4 from "@assets/images/desk4.jpg";
import image5 from "@assets/images/desk5.jpg";
import image6 from "@assets/images/desk6.jpg";
import image7 from "@assets/images/desk7.jpg";
import image8 from "@assets/images/desk8.jpg";
import {IMAGE_FORMAT} from "@components/react/carousel/Carousel";
import type {CarouselImage} from "@components/react/carousel/Carousel";

type Images = Omit<CarouselImage, "imgSrc"> & Record<"img", ImageMetadata>;
const images: Images[] = [
	{
		id: 1,
		format: IMAGE_FORMAT.LANDSCAPE,
		img: image1,
		alt: "Desk Image 1",
	},
	{
		id: 2,
		format: IMAGE_FORMAT.PORTRAIT,
		img: image2,
		alt: "Desk Image 2",
	},
	{
		id: 3,
		format: IMAGE_FORMAT.PORTRAIT,
		img: image3,
		alt: "Desk Image 3",
	},
	{
		id: 4,
		format: IMAGE_FORMAT.LANDSCAPE,
		img: image4,
		alt: "Desk Image 4",
	},
	{
		id: 5,
		format: IMAGE_FORMAT.LANDSCAPE,
		img: image5,
		alt: "Desk Image 5",
	},
	{
		id: 6,
		format: IMAGE_FORMAT.LANDSCAPE,
		img: image6,
		alt: "Desk Image 6",
	},
	{
		id: 7,
		format: IMAGE_FORMAT.PORTRAIT,
		img: image7,
		alt: "Desk Image 7",
	},
	{
		id: 8,
		format: IMAGE_FORMAT.LANDSCAPE,
		img: image8,
		alt: "Desk Image 8",
	},
];

const optimizedImages: CarouselImage[] = [];
images.map(async ({img, ...rest}) =>
	optimizedImages.push({
		...rest,
		imgSrc: (await getImage({src: img})).src,
	}),
);
---

<Layout>
	<Showcase />
	<CompaniesLogos />
	<Experience />
	<Projects />
	<Contact client:load>
		<Icon name="ri:alert-line" width={15} height={15} />
	</Contact>
	<Uses client:only="react" images={optimizedImages} />
</Layout>

<script>
	import {onContentReady} from "@utils/utils";
	const [, hash] = window.location.hash.split("#");
	const ready = await onContentReady();

	if (hash && ready) {
		const element = document.getElementById(hash);
		element?.scrollIntoView({
			block: "start",
			behavior: "smooth",
		});
		element?.focus();
	}
</script>
